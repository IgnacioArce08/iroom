<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="iroom.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <header>
        <h1>Información de las Estaciones</h1>
    </header>
    <div id="general">
        <table class="tabla1" id="tabla4">
            <thead>
                <tr>
                    <th>Ciudad</th>
                    <th>Temperatura(º)</th>
                    <th>Humedad(%)</th>
                    <th>Ruido</th>
                    <th>Nivel de luz</th>
                    <th>Color de iluminación</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th>Mostrar histograma</th>
                    <td><input type="checkbox" class="checkbox" name="column" value="1" id="temperatura" onclick="HacerHistograma(this.value)"></td>
                    <td><input type="checkbox" class="checkbox" name="column" value="2" id="humedad" onclick="HacerHistograma(this.value)"></td>
                    <td><input type="checkbox" class="checkbox" name="column" value="3" id="ruido" onclick="HacerHistograma(this.value)"></td>
                    <td><input type="checkbox" class="checkbox" name="column" value="4" id="nivel_de_luz" onclick="HacerHistograma(this.value)"></td>
                </tr>
                <tr>
                    <td>Alcalá de H.</td>
                    <td>25</td>
                    <td>48</td>
                    <td>150</td>
                    <td>120</td>
                    <td>000000</td>
                </tr>
                <tr>
                    <td>Alicante</td>
                    <td>30</td>
                    <td>69</td>
                    <td>180</td>
                    <td>211</td>
                    <td>FF0000</td>
                </tr>
                <tr>
                    <td>Badajoz</td>
                    <td>35</td>
                    <td>30</td>
                    <td>50</td>
                    <td>150</td>
                    <td>00FF00</td>
                </tr>
                <tr>
                    <td>Burgos</td>
                    <td>18</td>
                    <td>42</td>
                    <td>211</td>
                    <td>180</td>
                    <td>0000FF</td>
                </tr>
                <tr>
                    <td>Córdoba</td>
                    <td>35</td>
                    <td>41</td>
                    <td>150</td>
                    <td>50</td>
                    <td>FFFFFF</td>
                </tr>
            </tbody>
        </table>

        <!-- Contenedor del histograma -->
        <div id="histograma-container" class="histograma-container">
            <canvas id="histograma-chart"></canvas>
        </div>

        <br>

        <nav>
            <a href="tablas.html" class="pagina-link" data-pagina="1">Página 1</a>
            <a href="pagina2.html" class="pagina-link" data-pagina="2">Página 2</a>
            <a href="pagina3.html" class="pagina-link" data-pagina="3">Página 3</a>
            <a href="pagina4.html" class="pagina-link" data-pagina="4">Página 4</a>
        </nav>
    </div>
    <script>
        function HacerHistograma(columnValue) {
            var histogramContainer = document.getElementById("histograma-container");

            // Oculta todos los histogramas
            var allHistograms = document.getElementsByClassName("histograma-container");
            for (var i = 0; i < allHistograms.length; i++) {
                allHistograms[i].style.display = "none";
            }

            // Muestra el histograma correspondiente
            var currentHistogram = document.getElementById("histograma-" + columnValue);
            currentHistogram.style.display = "block";

            // Limpia el contenedor del histograma
            histogramContainer.innerHTML = "";

            // Obtener los nombres de las ciudades y valores de la columna seleccionada
            var cityNames = [];
            var columnValues = [];

            $("#tabla4 tbody tr").each(function (index, row) {
                var cells = $(row).find("td");

                if (index !== 0 && cells.length > 0) {
                    cityNames.push(cells.eq(0).text()); // Nombre de la ciudad (primera columna)
                    columnValues.push(parseInt(cells.eq(columnValue).text())); // Valor de la columna seleccionada
                }
            });

            // Crear un gráfico de barras con Chart.js
            var ctx = document.getElementById("histograma-chart").getContext("2d");
            var histogramChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: cityNames,
                    datasets: [{
                        label: 'Histograma',
                        data: columnValues,
                        backgroundColor: '#7e7100',
                    }],
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                        },
                    },
                },
            });
        }
    </script>
</body>

</html>
